<form>
  <label>ASD Essential 8 - User application hardening - Overview</label>
  <fieldset submitButton="true">
    <input type="time" token="field1">
      <label></label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
     <input type="radio" token="showGuidance" searchWhenChanged="true">
      <label>Show Guidance</label>
      <choice value="true">On</choice>
      <choice value="false">Off</choice>
      <default>true</default>
      <initialValue>true</initialValue>
      <change>
        <condition value="true">
          <set token="showDescription">true</set>
          <set token="showHowToUse">true</set>
          <set token="showExampleSources">true</set>
        </condition>
        <condition>
          <unset token="showDescription"></unset>
          <unset token="showHowToUse"></unset>
          <unset token="showExampleSources"></unset>          
       </condition>      
      </change>
    </input>
  </fieldset>
  <row depends="$showDescription$">
    <panel>
      <title>Description</title>
      <html>
      <p>Block web browser access to Adobe Flash Player (uninstall if possible), web ads and untrusted Java code on the Internet.  Flash, Java and web ads have long been popular ways to deliver malware to infect computers. This page provides an overview of how you are tracking against key metrics in reporting against Application whitelisting. Providing total counts of allowed, blocked and audit application whitelisting events.  With the data collected from the 3 prior categories and data from a assett inventory source, such as Active directory, we can then identify the percentage coverage of hosts that have application whitelisting enforced in your environment.</p>
    </html>
    </panel>
  </row>
  <row depends="$showHowToUse$">
    <panel>
      <title>How to Use This Dashboard</title>
      <html>
      <p>When reviewing this dashboard you should pay attention to the percentage of hosts that have application whitelisting and also trends in application whitelisting blocked execution and audit execution trends</p>
    </html>
    </panel>
  </row>
  <row>
    <panel>
      <title>Blocked Web Ads</title>
      <single>
        <search>
          <query>|inputlookup essential8 | search control=webads_blocked | eval _time=strptime(date,"%d/%m/%Y %H:%M:%S") | timechart values(value) as value</query>
          <earliest>1490706000</earliest>
          <latest>1491314400</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">block</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x65a637","0x6db7c6","0xf7bc38","0xf58f39","0xd93f3c"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="unitPosition">after</option>
        <option name="useColors">1</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <title>Allowed Web Ads</title>
      <single>
        <search>
          <query>|inputlookup essential8 | search control=webads_allowed | eval _time=strptime(date,"%d/%m/%Y %H:%M:%S") | timechart values(value) as value</query>
          <earliest>1490706000</earliest>
          <latest>1491314400</latest>
        </search>
        <option name="colorBy">trend</option>
        <option name="colorMode">block</option>
        <option name="trendColorInterpretation">inverse</option>
        <option name="trendDisplayMode">percent</option>
        <option name="useColors">1</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Flash Player</title>
      <chart>
        <search>
          <query>|inputlookup essential8 | search control=user_app_hardening_flash_* | eval _time=strptime(date,"%d/%m/%Y %H:%M:%S") | timechart values(value) as value by control | rename user_app_hardening_flash_allowed as "Flash Allowed" user_app_hardening_flash_blocked as "Flash Blocked"</query>
          <earliest>1490706000</earliest>
          <latest>1491314400</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.chart.stackMode">stacked</option>
      </chart>
    </panel>
  </row>
    <row depends="$showExampleSources$">
    <panel>
      <title>Example data sources to power this dashboard</title>
      <html>
       <p>
          <ul>
    <li><b>Application Whitelisting Data</b> - Microsoft Applocker, Symantec Endpoint Protection, Airlock Digital, Heat Application Control.  These sources must log Allows, Blocks and Audit to provide accurate data</li>
    <li><b>Assett Inventory Data</b> - Microsoft Active Directory, CMDB, SCCM.  These sources must log the hostnames to allow comparison to Application Whitelisting Data.</li>
  </ul>
      </p>
    </html>
    </panel>
  </row>
</form>